# オブジェクトを見つける

## 3.1 発見の戦略
初期設計での良いオブジェクトを発見すること、というのは、  
アプリケーションのドメイン、およびその実行機構の一部となる抽象概念を識別すること。  
以下の手法を用いて、ドメインの候補を考えると良い。
* おおまかな設計ストーリーを書く。そこにはアプリケーションにおいて重要な事を記述する。
* このストーリーを用いて、アプリケーションの中心的な関心ごととなるテーマを、いくつか挙げる
* それぞれのテーマを取り囲み、サポートするオブジェクトの候補を考える。その際、システムの振る舞いやアーキテクチャ、性能、構造という観点から考えてみる。
* ソフトウェアの外側にある、ユーザーや外部プログラムなどについても考える
* 追加すべきメカニズムや機構を表すオブジェクトを考え、そのオブジェクトに名付けや概要の記述、性格付けを行う。
* オブジェクトをグループ分けする。アプリケーションを、地域(共通の問題に対して取り組むオブジェクトのまとまり)に無理なく分割できるか考える
* 列挙したオブジェクトが、抽象概念として妥当か検討し、根拠を述べる
* オブジェクトをだんだん見つけられなくなったら、責務とコラボレーションのモデリングに移る

初期段階で出てくるオブジェクトは、20～30くらいが目安。作業が進むにつれて、オブジェクトの数がどんどん増えてくる。


## 3.2 オブジェクト、ロール。クラスを探す
最初に、概念・機構・メカニズムといった重要な物事を表現するオブジェクトを挙げていく。  

まず、はっきりとしたロールを持つオブジェクトを挙げていく。  
その後、そのオブジェクトが知っているべきことや行うべきこと(ロール)を挙げる。  
そして、コラボレートする相手のオブジェクトを決める。

個々のロールを考えることから、オブジェクトどうしの共通点を考えていく。  
異なるオブジェクトが共通の責務を持っていれば、共通のロールを定義できる(?)
オブジェクトやロールが、クラスやインターフェースとしてどう実現されるかを考えるのは、オブジェクトやロールがそのまま設計に残るべきだと判断された後にする。
その後、継承、抽象クラス化、インターフェースなどを定義する。


## 3.3 なぜ設計ストーリーを語るのか
アプリケーションについての重要な側面を、2段落以下でストーリーに落とす。  
ユースケース、要求、アーキテクチャ、ユーザー、予算責任者、あたりの視点を考えつつ、シンプルにまとめあげる。  
P94に例があるが、正直これのどこが大雑把かよくわからない。段落、とは。  
ストーリーを書いてみて、中心となる感心事やテーマをいくつか（5つ以内くらい？）に絞ってみる。  
主要なテーマを絞るのが、おそらくここでの1番の目的。


## 3.4 探索の戦略
主要なテーマから、アプリケーションの性質やそのアプリケーションにとって不可欠なものに基づき、  
どのようなものを考える必要があるか、経験と知識を元に列挙する。  
例えば、以下のものを考える。
* システムが行う作業
* 他のソフトウェア、物理的な機構、ハードウェアデバイスといった、アプリケーションが直接影響するものや接続するもの
* ソフトウェア内を流れる情報
* 判断、制御、調整のアクティビティ
* オブジェクトの構造とグループ
* アプリケーションが知っている必要のある、実世界の物事を表現するもの

これらを考えることで、ロールステレオタイプの役割を持つようなオブジェクトを考える。  
他のシステムへの接続は、インターフェース役のオブジェクトとしてモデル化する。  
ソフトウェアを使うユーザーが誰かによって、ソフトウェアの振る舞いが異なる時のみ、ユーザーを表す何かをオブジェクトとして表してみる。  
→ ユーザーに寄ってアクセス権が違う、パスワード再発行する場合に、ユーザーに関する知識が必要、など。
P99,100にこれらの例がある。  
また、上記の観点をサポートするオブジェクトも考えてみる。


## 3.5 名前には何が込められているのか
オブジェクトに適切な名前をつけるためには、オブジェクトが行うことを解釈しつつ、自分が既に何かと一致する名前をつけることである。  

汎用的な名前は修飾して、特殊なケースの説明を付け加える。
* カレンダー(Calendar)
    * グレゴリオ暦(GregorianCalendar)
    * ユリウス暦(JulianCalendar)
    * 中国歴(ChineseCalendar)


1つの名前には、最も明らかで重要な事実だけを入れよう
* ミリ秒タイマー最大誤差プラスマイナス2ミリ秒
* タイマー
また、オブジェクトの命名は、実装者でなく利用者に対して意味のある名前を付ける。  
シングルトンクラスに対して「～Singleton」というクラス名を付けるのは、利用者にとってはほとんどが意味が無い。


サービス提供役には「ワーカー(worker)」名をつける(Javanoサービス提供役のほとんどがそう)
* worker
* doer
* mover
* shaker
* Loader
* Viewer
ワーカー形式がしっくりこなければ、「～Service」もよい。


広範な責務を暗示する名前を持つオブジェクトを補うために、追加すべきオブジェクトを探す
→ 幅広い責務を連想させる名前に出会ったら、誤った名前を付けていないか確認します。オブジェクトの焦点を絞るべきか、はたまた、概念自体がさらなる展開を必要とするか。

* 口座関連サービス → 具体的でない
    * 残高照会サービス
    * 支払いサービス
    * 振込サービス
少なくとも3つの異なる特別なケースがあれば、一般概念と特化概念の両方を残す。特化概念が責務を1つも共有しない場合は、抽象概念はいつでも捨てられる。

~~十分な意味を伝える一方で、限定しすぎない名前を選ぶ。オブジェクトが対処出来るだけの出来る限り大きな責務を与え、細かい調整に寄って異なる状況でも使用できる余地を残す。オブジェクトが様々な状況に適合できるなら、それはより強力な設計である。~~
* 履歴 → 多くの事柄に関する履歴を残したい場合に付ける名前
* 取引履歴 → 取引の記録をモデル化
