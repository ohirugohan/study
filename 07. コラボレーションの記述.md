# 7.1 コラボレーションストーリーを伝える
オブジェクトがコラボレートする方法を説明するためには、ストーリーを語る必要がある。  
何を説明する必要があるか、相互作用がどれほど複雑であるかで、ストーリーの内容は深くも浅くもなる。

# 7.2 コラボレーションストーリーを開発するための戦略
ストーリーは、読み手が知りたいと思うことを簡単に理解できる形で表現されて、初めて意味を成す。  
たいてい複数の形式が必要になる。  

ストーリーを作成し始める前に、何を達成したいかを考える。以下、どんなコラボレーションストーリーの開発にも使える基本的な計画。
* 対象範囲、深さ、トーンを決める
* ストーリーが扱う項目を一覧にまとめる
* どの程度の詳しさで説明すべきかを決定する
* ストーリーを伝えるための適切な形式を選ぶ
* ストーリーを伝え、描き、説明する
* ストーリーを構成する
* 必要に応じで、改訂し、明確化し、拡張する。
自分が何を伝えようとしているか、伝える相手ををストーリーを作る前にまず確認。  
そして、特に強調するべき箇所を特定しておく。

# 7.3 対象範囲、深さ、トーンを決める
ストーリーを語る場合、どれほどの大きさの領域を対象にするかは、目的によって変わる。
たいてい、ストーリーは知識を伝えるか反応を得るかを目的にし、手早く説明される。  
説明は意識的に大雑把なものにする。

# 7.4 対象とするものを一覧にまとめる
ストーリーが広い範囲を対象にするならば、伝えるべきことは多くありますが、
まず頭に浮かんだすべてのことを一覧に揚げつつ、主要なポイントが何であるかを考える。  
ストーリーを書き終えるまでは提示するまでの良い手段が不明なので、  
ストーリーの大部分を書き終えるまではストーリーや一覧上の項目をどのように構成するかは考えない。

# 7.5 ストーリーの詳しさを決定する
コラボレーションを捉える視点にはいくつかあるので、示していく

## (全体的なアーキテクチャと一般的なコラボレーションの経路を示す、システムコンポーネントとサブシステムに対する)鳥瞰的な視点
システムがどのようにサブシステムで構成されるかを示し、それらのサブシステム間のコラボレーションを図示する。  
個々のオブジェクト間のコラボレーションは意識しない。  
どのくらい厳密に説明するか
* 一般的ンナコラボレーションの経路
* 各サブシステムのインターフェースがサポートする操作の列挙

## あるコラボレーションに関与するオブジェクトだけを示す視点
CRCカードを使って、高いレベルでコラボレートションを記述する。(またはUMLのコラボレーション図)  
コラボレーションするオブジェクト間に線(リンクと呼ぶ)を引く。  
リンクに矢じりを補足し、参照可能性を示す
CRCカードには、オブジェクト名の他に、ロールも書いておく。厳密にするならクラス名を書いておいても良い。  
P288,289を参照

## コラボレータ間の相互作用の順序の視点
コラボレーション図に、メッセージの順序を示す数を加えたり、メッセージの流れを示す矢印線を加えたりすることで表現可能。詳しくはP291。  
他にも、シーケンス図が使用可能。こちらもP291

## オブジェクトの詳細への視点
1つの相互作用の中で、分岐、オブジェクトの生成削除、繰り返し、非同期通信、アクティブオブジェクト、再帰なども表現可能。  
相互作用が複雑な判断を含む場合、代替パスを説明するための表記を用いてシーケンス図で図示可能(P292図)（？）  
実行するタイミングに制約がある場合は、それもシーケンス図で記述可能。P293図参照  
並行性があるアプリケーションには、制御フローが複数ある。複数の相互作用の流れが、論理的には同時に発生しうる時もある。  
アクティブオブジェクト、非同期メッセージ、ブロードキャストメッセージの3要素を使って、シーケンス図で表現可能。(P294)  

## 焦点を絞って相互作用を示す
システムの一部をブラックボックス化するような場合は、そこの部分に焦点を当てて相互作用を説明する。  
焦点を充てる部分以外は、説明を抽象化したり省略する。  
例えば、ユーザーがボタンをクリックした後に何が起こるかを説明する場合、保存ボタンについての詳細な説明は要らない。  
「保存ボタンを押す」ではなく、「文書を保存する」でいい。

## 実装の焦点を示す
既にコーディングしたものを文書化する場合、その文書が提案中のものではなく既に動作しているものであることを、明確にラベリングする。  
図や文書はコードほど正確ではないので。
そして、メッセージのシグニチャ、重要な戻り値、分岐、相互作用という具体的な情報をきちんと盛り込む。  
ただし、全てを表現するのではなく、強調したいものをきちんと強調する。

## コラボレーションを適応させる方法を、一般的に伝えるための視点
適応：「後からコラボレータを追加したり入れ替えたりしても、問題無く動作すること」？  
「後からカスタマイズ可能であること」？  
  
あるコラボレータを別のコラボレータと入れ替えたり、特定の条件やパラメータを設定したり、既存のオブジェクトを保管する新しいオブジェクトを組み込むためには、  
現在の設計がどのように動作しているか、どの部分が後からいじれるのか、どのようにいじるのか、の3つを説明する必要がある。  

コラボレーション図に、新しいコラボレータが組み込まれる可能性のある場所に印をつける(P297)

コラボレートするロールのパターンを作り上げた場合(?)  
このようなコラボレーションは、入れ替えするのではなく、採用(インスタンス化)しなければならない(?)  

パターンの各ロールを果たすオブジェクト群の設計をする。  
コラボレーションと呼ばれているUML表記を使う。コラボレーションに名前をつけ、それぞれの参加者オブジェクトに向かって点線を描き、点線にロール名を付ける。

## UML図では不十分な場合
複雑なアルゴリズムを考える。  
バブルソートについてのシーケンス図を見ると、アルゴリズムの重要な側面を見分けたり、アルゴリズムが確かに進行していることを理解することすら困難。  
アルゴリズムについての詳細は、以下の様な表現方法を複数使って表現する
* テキスト
* アルゴリズムの動作を可視化
* いっそのことコードを書く（実際のコードまたは擬似的なコード）
* BNF文法
* 状態マシン図
* 決定表
* その他あるとわかりやすい図

シーケンス図を書くと、シーケンス図内の全てのメッセージが同じくらい重要に思えてきてしまう側面がある。  
何らかの方法で強調しないと、特別なものには見えない。  
例外についての説明は、無理にシーケンス図で説明するのではなく、別途表を作ると良い。(P303)
